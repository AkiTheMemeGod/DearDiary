{% extends "base.html" %}

{% block title %}Cover - Dear Diary{% endblock %}

{% block content %}
<div class="desk-surface cinematic-fade-in">

    <!-- Zone 1: The Greeting (Left Upper) -->
    <div class="greeting-zone">
        <h1 class="handwritten-greeting" id="greeting">Hello, {{ user.username }}</h1>
        <div class="scribble-underline">
            <svg width="200" height="15" viewBox="0 0 200 15" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M2.5 12.5C40 2.5 100 5 197.5 10" stroke="#8b5a5b" stroke-width="2" stroke-linecap="round" />
            </svg>
        </div>
        <div class="date-stamp" id="date-display"></div>
    </div>

    <!-- Zone 2: Daily Whisper (Right Upper - Sticky Note) -->
    <div class="whisper-zone">
        <div class="sticky-note">
            <div class="tape-strip top-center"></div>
            <p class="quote-text" id="daily-quote">"Keep some room in your heart for the unimaginable."</p>
            <p class="quote-author" id="quote-author">- Mary Oliver</p>
            <div class="doodle-star">
                <svg width="30" height="30" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path
                        d="M15 2.5L18.5 10.5L27.5 11.5L20.5 17.5L22.5 26.5L15 22L7.5 26.5L9.5 17.5L2.5 11.5L11.5 10.5L15 2.5Z"
                        stroke="#5a5a5a" stroke-width="1" stroke-linejoin="round" />
                </svg>
            </div>
        </div>
    </div>

    <!-- Zone 3: Main Actions (Center/Bottom - scattered) -->
    <div class="action-zone">

        <!-- Write Action: The "Open Journal" -->
        <a href="{{ url_for('new_entry_page') }}" class="action-item journal-link">
            <div class="journal-paper">
                <span class="action-title">Dear Diary,</span>
                <p class="action-desc">I have thoughts to pour out today...</p>
                <div class="ink-stain"></div>
            </div>
        </a>

        <!-- Read Action: The "Photo Stack" -->
        <a href="{{ url_for('entries') }}" class="action-item memory-link">
            <div class="photo-stack">
                <div class="photo-backing"></div>
                <div class="photo-front">
                    <div class="photo-frame">
                        {% if latest_image %}
                        <img src="{{ url_for('get_image', image_id=latest_image.id) }}" alt="Latest Memory"
                            class="memory-thumb">
                        {% else %}
                        <div class="placeholder-img"></div>
                        {% endif %}
                    </div>
                    <span class="action-label">My Memories</span>
                </div>
            </div>
        </a>
    </div>

    <!-- Zone 4: Sparkle (Bottom Left - Scrap) -->
    <div class="sparkle-zone">
        <div class="scrap-paper">
            <span class="prompt-marker">Prompt:</span>
            <span id="writing-prompt">What made you smile today?</span>
        </div>
    </div>

</div>

<script>
    // 1. Greeting
    const hour = new Date().getHours();
    const greetingEl = document.getElementById('greeting');
    let greetingText = 'Hello';
    if (hour < 12) greetingText = 'Good morning';
    else if (hour < 18) greetingText = 'Good afternoon';
    else greetingText = 'Good evening';
    greetingEl.textContent = `${greetingText}, {{ user.username }}`;

    // 2. Date
    const options = { weekday: 'long', month: 'long', day: 'numeric' };
    document.getElementById('date-display').textContent = new Date().toLocaleDateString('en-US', options);

    // 3. Quotes
    const quotes = [
        { text: "Keep some room in your heart for the unimaginable.", author: "Mary Oliver" },
        { text: "And here you are, living despite it all.", author: "Rupi Kaur" },
        { text: "What you seek is seeking you.", author: "Rumi" },
        { text: "The sun will rise and we will try again.", author: "TOP" },
        { text: "Breathe. Itâ€™s just a bad day, not a bad life.", author: "" },
        { text: "Grow through what you go through.", author: "" }
    ];
    const item = quotes[Math.floor(Math.random() * quotes.length)];
    document.getElementById('daily-quote').textContent = item.text;
    document.getElementById('quote-author').textContent = item.author ? `- ${item.author}` : '';

    // 4. Prompts
    const prompts = [
        "What made you smile today?",
        "Describe a color that represents your mood.",
        "What is a small victory you had recently?",
        "Who are you grateful for right now?",
        "What is the best thing that happened this week?"
    ];
    document.getElementById('writing-prompt').textContent = prompts[Math.floor(Math.random() * prompts.length)];
</script>

<style>
    .desk-surface {
        position: relative;
        max-width: 1000px;
        margin: 0 auto;
        padding: 2rem;
        min-height: 80vh;
        /* Using grid strictly for zoning, but contents will float organically */
        display: grid;
        grid-template-columns: 1fr 1fr;
        grid-template-rows: auto 1fr auto;
        gap: 2rem;
    }

    /* --- Greeting Zone --- */
    .greeting-zone {
        grid-column: 1 / 2;
        padding-top: 2rem;
        padding-left: 2rem;
    }

    .handwritten-greeting {
        font-family: var(--font-handwriting);
        font-size: 5rem;
        color: var(--ink-primary);
        margin: 0;
        line-height: 0.8;
        transform: rotate(-2deg);
    }

    .scribble-underline {
        margin-left: 1rem;
        opacity: 0.8;
    }

    .date-stamp {
        font-family: var(--font-body);
        font-size: 1.2rem;
        color: var(--ink-secondary);
        margin-top: 1rem;
        font-style: italic;
        letter-spacing: 0.05em;
    }

    /* --- Whisper Zone (Sticky Note) --- */
    .whisper-zone {
        grid-column: 2 / 3;
        display: flex;
        justify-content: center;
        align-items: flex-start;
        padding-top: 3rem;
    }

    .sticky-note {
        background-color: #fdf6e3;
        /* Solarized light yellow/beige */
        width: 250px;
        padding: 2rem 1.5rem;
        box-shadow: 2px 4px 6px rgba(0, 0, 0, 0.1);
        transform: rotate(3deg);
        position: relative;
        transition: transform 0.3s ease;
    }

    .sticky-note:hover {
        transform: rotate(1deg) scale(1.02);
    }

    .tape-strip.top-center {
        position: absolute;
        top: -15px;
        left: 50%;
        transform: translateX(-50%) rotate(-1deg);
        width: 100px;
        height: 30px;
        background: rgba(255, 255, 255, 0.4);
        border: 1px solid rgba(0, 0, 0, 0.05);
        box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        backdrop-filter: blur(2px);
    }

    .quote-text {
        font-family: var(--font-handwriting);
        /* Handwritten quote */
        font-size: 1.8rem;
        line-height: 1.3;
        color: var(--ink-primary);
        margin-bottom: 1rem;
    }

    .doodle-star {
        position: absolute;
        bottom: 10px;
        right: 10px;
        opacity: 0.3;
        transform: rotate(15deg);
    }

    /* --- Action Zone --- */
    .action-zone {
        grid-column: 1 / -1;
        display: flex;
        justify-content: center;
        gap: 6rem;
        /* Large gap */
        align-items: center;
        padding: 4rem 0;
    }

    .action-item {
        text-decoration: none;
        color: inherit;
        position: relative;
        transition: transform 0.3s ease;
        cursor: pointer;
    }

    .action-item:hover {
        transform: translateY(-5px);
        z-index: 10;
    }

    /* Journal Style Link */
    .journal-paper {
        background: #fff;
        width: 320px;
        height: 220px;
        padding: 2rem;
        border: 1px solid #e0e0e0;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
        background-image: repeating-linear-gradient(transparent, transparent 23px, #f0f0f0 24px);
        transform: rotate(-1deg);
        display: flex;
        flex-direction: column;
        justify-content: center;
        border-radius: 2px;
    }

    .journal-paper::before {
        /* Folded corner effect strictly via CSS gradient if wanted, sticking to simple shadow for now */
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        box-shadow: inset 0 0 20px rgba(0, 0, 0, 0.02);
        pointer-events: none;
    }

    .action-title {
        font-family: var(--font-handwriting);
        font-size: 3rem;
        color: var(--ink-accent);
        margin-bottom: 0.5rem;
    }

    .action-desc {
        font-family: var(--font-body);
        font-size: 1.2rem;
        color: var(--ink-secondary);
        font-style: italic;
    }

    /* Photo Stack Style Link */
    .photo-stack {
        position: relative;
        width: 220px;
        height: 260px;
        transform: rotate(4deg);
    }

    .photo-backing {
        position: absolute;
        top: 5px;
        left: -5px;
        width: 100%;
        height: 100%;
        background: #fff;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        transform: rotate(-5deg);
        z-index: 1;
        border: 1px solid #eee;
    }

    .photo-front {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: #fff;
        padding: 15px 15px 40px 15px;
        /* Polaroid padding */
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        z-index: 2;
        display: flex;
        flex-direction: column;
        align-items: center;
    }

    .photo-frame {
        width: 100%;
        height: 180px;
        background: #f4f4f4;
        margin-bottom: 15px;
        overflow: hidden;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .placeholder-img {
        width: 100%;
        height: 100%;
        background-color: #eee;
        background-image: url("data:image/svg+xml,%3Csvg width='40' height='40' viewBox='0 0 40 40' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='%23d0d0d0' fill-opacity='0.4' fill-rule='evenodd'%3E%3Cpath d='M0 40L40 0H20L0 20M40 40V20L20 40'/%3E%3C/g%3E%3C/svg%3E");
    }

    .memory-thumb {
        width: 100%;
        height: 100%;
        object-fit: cover;
        display: block;
        filter: sepia(0.2) contrast(0.9);
    }

    .action-label {
        font-family: var(--font-handwriting);
        font-size: 1.8rem;
        color: var(--ink-primary);
    }

    /* --- Sparkle Zone (Scrap) --- */
    .sparkle-zone {
        grid-column: 1 / 2;
        grid-row: 3;
        display: flex;
        justify-content: flex-end;
        align-items: center;
    }

    .scrap-paper {
        background: #fff;
        padding: 1rem 2rem;
        max-width: 300px;
        /* Jagged edges via clip-path would be cool, but box-shadow is "comfier"/softer */
        border-bottom: 2px solid #eee;
        transform: rotate(-1deg);
        font-family: var(--font-body);
        font-size: 1.1rem;
        color: var(--ink-secondary);
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
    }

    .prompt-marker {
        font-weight: bold;
        color: var(--ink-accent);
        margin-right: 0.5rem;
    }

    /* Mobile */
    @media (max-width: 768px) {
        .desk-surface {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 3rem;
        }

        .greeting-zone,
        .whisper-zone,
        .action-zone,
        .sparkle-zone {
            width: 100%;
            grid-column: auto;
            text-align: center;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .action-zone {
            flex-direction: column;
            gap: 3rem;
        }

        .handwritten-greeting {
            font-size: 3.5rem;
        }
    }
</style>
{% endblock %}